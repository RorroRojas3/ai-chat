<div class="card border-0 rounded-5 prompt-box">
  <div class="card-body">
    <form id="promptForm">
      <div
        class="position-relative"
        (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave($event)"
        (drop)="onDrop($event)"
        [class.drag-over]="isDragOver"
      >
        <div class="row">
          <div class="col-12">
            <textarea
              class="form-control border-0 prompt-box-textarea"
              id="promptInput"
              rows="4"
              placeholder="Ask anything..."
              [(ngModel)]="prompt"
              [ngModelOptions]="{ standalone: true }"
            ></textarea>
          </div>
        </div>
        <div class="row">
          <div class="col-6">
            <div class="d-flex align-items-center gap-2">
              <div class="dropdown">
                <button
                  class="btn btn-prompt-box dropdown-toggle"
                  type="button"
                  id="dropdownMenuButton"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  {{ this.storeService.selectedModelId() || "Models..." }}
                </button>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  @for (model of this.storeService.models(); track model) {
                  <li>
                    <a
                      class="dropdown-item"
                      (click)="onModelChange(model.name)"
                      >{{ model.name }}</a
                    >
                  </li>
                  }
                </ul>
              </div>
              <button
                type="button"
                class="btn btn-prompt-box"
                (click)="fileInput.click()"
              >
                <i class="bi bi-paperclip me-1"></i>
              </button>
            </div>
          </div>
          <div class="col-6 justify-content-end d-flex">
            <button
              type="submit"
              class="btn btn-prompt-box"
              [disabled]="this.storeService.disablePromptButton()"
              (click)="onClickCreateSession()"
            >
              <i class="bi bi-send"></i>
            </button>
          </div>
        </div>
        <input
          type="file"
          #fileInput
          multiple
          style="display: none"
          (change)="onFileSelect($event)"
          accept=".pdf,application/pdf"
        />
      </div>

      <!-- Attached Files Section
      @if (attachedFiles.length > 0) {
      <div class="mb-3">
        <h6 class="text-muted mb-2">
          <i class="bi bi-paperclip me-1"></i>
          Attached Files ({{ attachedFiles.length }})
        </h6>
        <div class="attached-files">
          @for (file of attachedFiles; track file.id) {
          <div
            class="file-item d-flex align-items-center justify-content-between p-2 mb-2 bg-light rounded"
          >
            <div class="d-flex align-items-center">
              <i class="bi bi-file-earmark me-2 text-secondary"></i>
              <span class="file-name">{{ file.name }}</span>
              <small class="text-muted ms-2"
                >({{ formatFileSize(file.size) }})</small
              >
            </div>
            <button
              type="button"
              class="btn btn-sm btn-outline-danger"
              (click)="removeFile(file.id)"
              title="Remove file"
            >
              <i class="bi bi-x"></i>
            </button>
          </div>
          }
        </div>
        <button
          type="button"
          class="btn btn-sm btn-outline-secondary me-2"
          (click)="fileInput.click()"
        >
          <i class="bi bi-plus me-1"></i>
          Add More Files
        </button>
        <button
          type="button"
          class="btn btn-sm btn-outline-danger"
          (click)="clearAllFiles()"
        >
          <i class="bi bi-trash me-1"></i>
          Clear All
        </button>
      </div>
      } @else {
      <div class="mb-3">
        <button
          type="button"
          class="btn btn-sm btn-outline-secondary"
          (click)="fileInput.click()"
        >
          <i class="bi bi-paperclip me-1"></i>
          Attach Files
        </button>
      </div>
      } -->
    </form>
  </div>
</div>
