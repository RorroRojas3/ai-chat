<div
  class="card border-0 rounded-5 prompt-box"
  [class.drag-over]="isDragOver"
  (dragover)="onDragOver($event)"
  (dragleave)="onDragLeave($event)"
  (drop)="onDrop($event)"
>
  <div class="card-body">
    <!-- Drag and drop overlay -->
    @if (isDragOver) {
    <div class="drag-overlay">
      <div class="drag-content">
        <i class="bi bi-files drag-icon"></i>
        <p class="drag-text">Drop file(s)</p>
      </div>
    </div>
    }
    <form
      id="promptForm"
      (ngSubmit)="onClickCreateSession()"
      (keydown)="onKeyDown($event)"
    >
      <div class="position-relative">
        <div class="row">
          <div class="col-12">
            <textarea
              class="form-control border-0 prompt-box-textarea"
              id="promptInput"
              rows="4"
              placeholder="Ask anything..."
              [(ngModel)]="prompt"
              [ngModelOptions]="{ standalone: true }"
              (keydown)="onTextareaKeyDown($event)"
            ></textarea>
          </div>
        </div>
        <div class="row">
          <div class="col-6">
            <div class="d-flex align-items-center gap-2">
              <div class="dropdown">
                <button
                  class="btn btn-prompt-box dropdown-toggle"
                  type="button"
                  id="dropdownMenuButton"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  @if (this.storeService.selectedModel().name) {
                  <i
                    class="me-2 {{
                      getServiceIcon(
                        this.storeService.selectedModel().aiServiceId
                      )
                    }}"
                  ></i>
                  {{ this.storeService.selectedModel().name }}
                  } @else { Models... }
                </button>
                <ul
                  class="dropdown-menu"
                  style="background-color: var(--color-light-blue)"
                  aria-labelledby="dropdownMenuButton"
                >
                  @for (model of this.storeService.models(); track model) {
                  <li>
                    <a class="dropdown-item" (click)="onModelChange(model)">
                      <i
                        class="me-2 {{ getServiceIcon(model.aiServiceId) }}"
                      ></i>
                      {{ model.name }}
                    </a>
                  </li>
                  }
                </ul>
              </div>
              <button
                type="button"
                class="btn btn-prompt-box"
                (click)="fileInput.click()"
              >
                <i class="bi bi-paperclip me-1"></i>
              </button>
            </div>
          </div>
          <div class="col-6 justify-content-end d-flex">
            <button
              type="submit"
              class="btn btn-prompt-box"
              [disabled]="this.storeService.disablePromptButton()"
              (click)="onClickCreateSession()"
            >
              <i class="bi bi-send"></i>
            </button>
          </div>
        </div>
        <input
          type="file"
          #fileInput
          multiple
          style="display: none"
          (change)="onFileSelect($event)"
          accept=".pdf,application/pdf"
        />
      </div>
    </form>

    <!-- File cards display -->
    @if (attachedFiles.length > 0) {
    <div class="file-cards-container mt-1">
      <div class="file-cards-scroll">
        @for (file of attachedFiles; track file.id) {
        <div class="file-card card">
          <div class="file-card-body card-body text-center">
            <div class="file-card-remove">
              <span class="badge bg-danger" (click)="removeFile(file.id)">
                <i class="bi bi-x"></i>
              </span>
            </div>
            <div class="file-card-icon">
              <i class="bi bi-file-earmark-pdf"></i>
            </div>
            <div class="file-card-name">{{ file.name }}</div>
            <div class="file-card-size">{{ formatFileSize(file.size) }}</div>
          </div>
        </div>
        }
      </div>
    </div>
    }
  </div>
</div>
